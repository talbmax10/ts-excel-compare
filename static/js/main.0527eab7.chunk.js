(this["webpackJsonpts-excel-compare"]=this["webpackJsonpts-excel-compare"]||[]).push([[0],{287:function(e,t){},404:function(e,t,n){e.exports=n(592)},409:function(e,t,n){},413:function(e,t){},414:function(e,t){},417:function(e,t){},419:function(e,t){},430:function(e,t){},432:function(e,t){},458:function(e,t){},460:function(e,t){},461:function(e,t){},467:function(e,t){},469:function(e,t){},487:function(e,t){},489:function(e,t){},501:function(e,t){},504:function(e,t){},510:function(e,t){},512:function(e,t){},590:function(e,t,n){},592:function(e,t,n){"use strict";n.r(t);var a=n(0),l=n.n(a),r=n(82),i=n.n(r),o=(n(409),n(104)),c=n(594),s=n(596),u=n(597),f=n(220),h=n(232),m=n.n(h),d=function e(){Object(f.a)(this,e),this.getSheet=function(e,t,n){return new Promise((function(a,l){var r=e.Sheets[t],i={items:m.a.utils.sheet_to_json(r,{header:1})};return a(i),n(null,i)}))},this.convertFileToExcel=function(e,t){return new Promise((function(n,a){var l=new FileReader,r=!!l.readAsBinaryString;l.onload=function(e){var a,l=null===e||void 0===e||null===(a=e.target)||void 0===a?void 0:a.result,i=m.a.read(l,{type:r?"binary":"array"}),o=i.SheetNames[0],c=i.Sheets[o],s={items:m.a.utils.sheet_to_json(c,{header:1}),sheets:i.SheetNames,workbook:i};return n(s),t(null,s)},e&&r?l.readAsBinaryString(e):l.readAsArrayBuffer(e)}))}};d.SheetJSFT=function(){return["xlsx"].map((function(e){return"."+e})).join(",")},d.BlankData=function(e,t){return new Array(e).fill("").map((function(){return new Array(t).fill("")}))},d.SampleDataLeft=function(){return[["Date","High","Low","Close","Volume","ask","cash"],["2019-07-08 00:00:00","11540.33","11469.53","11506.43","10.77073088","0","100000000"],["2019-07-07 19:00:00","11610.0","11432.32","11547.98","67.915214697","0","100000000"],["2019-07-07 18:00:00","11525.0","11426.74","11470.47","31.1094771869","0","100000000"],["2019-07-07 16:00:00","11254.97","11135.01","11201.6","23.5194946648","0","100000000"],["2019-07-07 15:00:00","11408.02","11189.0","11254.97","64.0821938629","0","100000000"]]},d.SampleDataRight=function(){return[["Date","High","Low","Close","Volume","bid","ask","Buy"],["2019-07-07 23:00:00","11482.72","11423.0","11475.07","32.99655899","6","0","3"],["2019-07-07 19:00:00","11610.0","11432.32","11547.98","67.915214697","6","0","9"],["2019-07-07 18:10:00","11525.0","11426.74","11470.47","31.1094771869","6","0","9"],["2019-07-07 17:20:00","11566.23","11211.56","11503.4","121.5246740453","0","9"],["2019-07-07 16:00:00","11254.97","11135.01","11200.6","23.5194946648","6","0","9"],["2019-07-07 15:00:00","11408.02","11189.0","11254.97","64.0821938629","6","1","9"]]};var g=n(288),p=n(171),S=n(595),b=(n(381),function(e){return l.a.createElement(S.a.Group,{compact:!0,style:{marginRight:10,marginTop:-25,marginBottom:3}},l.a.createElement("input",{name:"file-upload",style:{width:"50%",marginTop:10},type:"file",accept:d.SheetJSFT(),"aria-label":"Select original file",onChange:function(t){return e.onFileSelectChange(t)},ref:e.fileRef}),l.a.createElement(c.a,{style:{width:"40%"},value:e.sheetname,onChange:function(t){return e.onSheetSelectChange(t)}},e.sheetlist))});b.defaultProps={sheetname:"Sheet1",sheetlist:null};var v=b,y=function(e){return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"left",style:{padding:10,marginTop:-25}},l.a.createElement("h1",{style:{marginLeft:3}},"<\u5143\u30fboriginal>"),l.a.createElement(v,{sheetname:e.sheetname,sheetlist:e.sheetlist,onFileSelectChange:function(t){return e.onFileSelectChange(t)},onSheetSelectChange:function(t){return e.onSheetSelectChange(t)},fileRef:e.fileRef}),l.a.createElement(p.a,{ref:e.hotTableComponentLeft,data:e.sheetdata,style:{width:"98%"},settings:{colHeaders:!0,rowHeaders:!0,height:305,minRows:12,minCols:8,licenseKey:"non-commercial-and-evaluation",id:"table-left"},stretchH:"all"})))},w=function(e){return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"right",style:{padding:10,marginTop:-25}},l.a.createElement("h1",{style:{marginLeft:3}},"<\u5148\u30fbmodified>"),l.a.createElement(v,{sheetname:e.sheetname,sheetlist:e.sheetlist,onFileSelectChange:function(t){return e.onFileSelectChange(t)},onSheetSelectChange:function(t){return e.onSheetSelectChange(t)},fileRef:e.fileRef}),l.a.createElement(p.a,{ref:e.hotTableComponentRight,data:e.sheetdata,style:{width:"98%"},settings:{colHeaders:!0,rowHeaders:!0,height:305,minRows:12,minCols:8,licenseKey:"non-commercial-and-evaluation",id:"table-right"},stretchH:"all"})))},C=n(283),E=function(e){return l.a.createElement("div",{style:{textAlign:"center"}},l.a.createElement(C.a,{type:"dashed",size:"small",style:{marginTop:150},onClick:function(t){return e.onSampleBtnClick(t)}},"< Sample >"),l.a.createElement(C.a,{ref:l.a.createRef(),id:"btn-diff",type:"primary",style:{marginTop:10},size:"large",onClick:function(t){return e.onDiffBtnClick(t)}},e.btntext),l.a.createElement(C.a,{ref:l.a.createRef(),id:"btn-clean",type:"default",style:{marginTop:10},onClick:function(t){return e.onResetBtnClick(t)}}," << reset >> "))},O=n(397),j=function(){function e(t,n){Object(f.a)(this,e),this.value=void 0,this.instance=void 0,this.value=t,this.instance=n}return Object(O.a)(e,[{key:"getCell",value:function(e,t){var n=this.instance.getDataAtCell(t,e);return null===n?n:void 0===n?"":""+n}},{key:"getValue",value:function(){return this.value}}]),e}(),R=n(288);function k(e,t,n,a,l,r,i){var o=new j(r,e),c=new R.coopy.SimpleView,s=R.coopy.DiffRender.renderCell(o,c,a,n),u=s.category,f=s.pretty_value;return""!==u&&(t.className=u),t.innerHTML=f,f}var T=function(e){return"string"===typeof(t=e)||t instanceof String?e.replace(/(<([^>]+)>)/gi,""):e;var t},D=function(e){return l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{style:{fontSize:24}},"\u6bd4\u8f03\u7d50\u679c"),l.a.createElement("button",{onClick:function(){var t=e.hotTableComponentDiffResult.current.hotInstance.getData(),n="\ufeff";t.forEach((function(e){n+=function(e){return e.map((function(e){var t=null===e?"":e.toString();return((t=T(t)).includes(",")||t.includes('"'))&&(t='"'+t.replace(/"/g,'""')+'"'),t})).join(",")}(e)+"\r\n"}));var a=encodeURI("data:text/csv;charset=utf-8,"+n),l=document.createElement("a");l.setAttribute("href",a),l.setAttribute("download","comparison.csv"),document.body.appendChild(l),l.click(),document.body.removeChild(l)}},"\u062a\u0635\u062f\u064a\u0631 \u0625\u0644\u0649 Excel"),l.a.createElement(p.a,{ref:e.hotTableComponentDiffResult,data:[[""]],style:{width:"100%",padding:15},id:"tableresult",settings:{minRows:10,minCols:10,minSpareCols:0,minSpareRows:0,colHeaders:!1,contextMenu:!1,rowHeaders:!1,readOnly:!0,renderAllRows:!0,licenseKey:"non-commercial-and-evaluation"},renderer:k,className:"diffhandsontable",stretchH:"all"}))};n(589),n(590),n(591);var B=function(){var e=new d,t=Object(a.useState)("Sheet1"),n=Object(o.a)(t,2),r=n[0],i=n[1],f=Object(a.useState)(null),h=Object(o.a)(f,2),m=h[0],p=h[1],S=Object(a.useState)(l.a.createRef()),b=Object(o.a)(S,1)[0],v=Object(a.useState)(JSON.parse(JSON.stringify(d.BlankData(12,8)))),C=Object(o.a)(v,2),O=C[0],j=C[1],R=Object(a.useState)(),k=Object(o.a)(R,2),T=k[0],B=k[1],F=Object(a.useState)("Sheet1"),x=Object(o.a)(F,2),N=x[0],A=x[1],_=Object(a.useState)(null),H=Object(o.a)(_,2),J=H[0],L=H[1],V=Object(a.useState)(l.a.createRef()),I=Object(o.a)(V,1)[0],z=Object(a.useState)(JSON.parse(JSON.stringify(d.BlankData(12,8)))),K=Object(o.a)(z,2),M=K[0],P=K[1],W=Object(a.useState)(),G=Object(o.a)(W,2),U=G[0],$=G[1],q=Object(a.useState)(">> Diff <<"),Q=Object(o.a)(q,1)[0],X=Object(a.useState)(l.a.createRef()),Y=Object(o.a)(X,1)[0],Z=Object(a.useRef)(null),ee=Object(a.useRef)(null),te=function(t,n){if(t.persist(),t.target.files){var a=t.target.files[0];a&&e.convertFileToExcel(a,(function(e,t){if(e)console.log(e);else{for(var a=[],r=0;r<t.sheets.length;r++)a.push(l.a.createElement(c.a.Option,{key:t.sheets[r],value:t.sheets[r]},t.sheets[r]));"left"===n?(i(t.sheets[0]),p(a),j(t.items),B(t.workbook)):(A(t.sheets[0]),L(a),P(t.items),$(t.workbook))}}))}},ne=function(t,n){var a=null;void 0!==(a="left"===n?T:U)&&null!==a&&void 0!==t&&e.getSheet(a,t,(function(e,a){e?console.log(e):"left"===n?(i(t),j(a.items)):(A(t),P(a.items))}))};return l.a.createElement("div",{className:"App"},l.a.createElement(s.a,null,l.a.createElement(u.a,{span:11},l.a.createElement(y,{sheetname:r,sheetlist:m,onFileSelectChange:function(e){return te(e,"left")},onSheetSelectChange:function(e){return ne(e,"left")},hotTableComponentLeft:b,sheetdata:O,fileRef:Z})),l.a.createElement(u.a,{span:2},l.a.createElement(E,{btntext:Q,onDiffBtnClick:function(e){!function(e,t,n){var a=n.current.hotInstance,l=[],r=new g.TableView(e),i=new g.TableView(t);r.trim(),i.trim();var o=g.compareTables(r,i).align(),c=new g.TableView([]),s=new g.CompareFlags;s.show_unchanged=!1,s.always_show_header=!0,s.always_show_order=!0,s.never_show_order=!1,s.unchanged_context=!0,new g.TableDiff(o,s).hilite(c),0!==c.height&&(l=c.data,a.loadData(l))}(O,M,Y)},onSampleBtnClick:function(e){j(d.SampleDataLeft),P(d.SampleDataRight)},onResetBtnClick:function(e){Z.current.value="",ee.current.value="",p(null),L(null),i("Sheet1"),A("Sheet1"),j(JSON.parse(JSON.stringify(d.BlankData(12,8)))),P(JSON.parse(JSON.stringify(d.BlankData(12,8))))}})),l.a.createElement(u.a,{span:11},l.a.createElement(w,{sheetname:N,sheetlist:J,onFileSelectChange:function(e){return te(e,"right")},onSheetSelectChange:function(e){return ne(e,"right")},hotTableComponentRight:I,sheetdata:M,fileRef:ee})),l.a.createElement(u.a,{span:24,style:{textAlign:"center"}},l.a.createElement(D,{hotTableComponentDiffResult:Y}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(B,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[404,1,2]]]);
//# sourceMappingURL=main.0527eab7.chunk.js.map