# أداة مقارنة ملفات Excel

- مستوحاة من https://www.textcompare.org/excel/
- صفحة GitHub Pages الأصلية https://yinger.github.io/ts-excel-compare/

## نظرة عامة

تساعدك هذه الأداة على مقارنة ملفي Excel واكتشاف الفروقات بينهما بشكل مرئي وسريع. تم تعريب الواجهة بالكامل لتسهيل استخدامها من قبل المتحدثين باللغة العربية، كما تم توفير خيار لتصدير نتيجة المقارنة إلى ملف Excel.

## المزايا الرئيسية

- رفع ملفي Excel ومقارنتهما جنبًا إلى جنب.
- اختيار ورقة العمل المطلوب تحليلها من كل ملف.
- تسليط الضوء على الإضافات والحذف والتعديلات.
- استثناء الأعمدة غير المهمة قبل المقارنة باستخدام أسماء الأعمدة الأصلية من الملفات.
- تصدير نتيجة المقارنة كملف Excel جاهز للمشاركة أو الأرشفة.

## كيفية الاستخدام

1. اختر الملف الأصلي من القسم الأيسر.
2. اختر الملف المعدَّل من القسم الأيمن.
3. انتقل بين أوراق العمل من خلال القائمة المنسدلة عند الحاجة.
4. استخدم زر **تحميل مثال** لتجربة الأداة ببيانات افتراضية.
5. اضغط زر **استثناء الأعمدة** وحدد أسماء الأعمدة التي لا ترغب في تضمينها في المقارنة.
6. اضغط زر **نفّذ المقارنة** لاستعراض الفروقات بناءً على الأعمدة المتبقية.
7. استخدم زر **إعادة التعيين** لمسح البيانات والبدء من جديد.

## تصدير النتائج إلى Excel

بعد إظهار الفروقات يمكنك الضغط على زر **تصدير النتائج إلى Excel** لتنزيل ملف بصيغة `comparison-results.xlsx` يحتوي على جدول الفروقات بدون أي تنسيق HTML إضافي.

## النشر على GitHub Pages

تم تجهيز المشروع للعمل مع GitHub Pages بطريقتين: تشغيل سكربت النشر يدويًا أو الاعتماد على GitHub Actions لنشر التحديثات تلقائيًا مع كل دفع (push) إلى الفرع `master`.

### إعداد المستودع على GitHub

1. أنشئ مستودعًا جديدًا على GitHub (عام أو خاص مع تفعيل Pages لاحقًا).
2. اربط المستودع المحلي بالبعيد إذا لم يكن هناك `origin`:

   ```bash
   git remote -v
   git remote add origin git@github.com:<اسم_المستخدم>/<اسم-المستودع>.git
   ```

3. ادفع الفرع الحالي (أو `master`) لتفعيل سير العمل والتأكد من أن GitHub Pages لديها مصدر للنشر:

   ```bash
   git push -u origin <اسم-الفرع-الحالي>
   ```

### النشر التلقائي (مُستحسن)

1. تأكد من أن المستودع مفعَّل عليه GitHub Pages من الإعدادات (Settings ▸ Pages) مع اختيار المصدر **GitHub Actions**.
2. ادفع الملف `.github/workflows/deploy.yml` إلى المستودع (موجود في هذا المشروع بشكل افتراضي).
3. في كل مرة تدفع فيها تغييراتك إلى الفرع `master` سيقوم سير العمل بتثبيت الاعتماديات، تنفيذ أمر `npm run build`، ثم نشر مجلد `build` إلى GitHub Pages تلقائيًا.

### النشر اليدوي

1. تأكد من إعداد خاصية `homepage` في `package.json` لتشير إلى مسار صفحتك (على سبيل المثال: `https://<اسم_المستخدم>.github.io/<اسم-المستودع>`).
2. ثبّت الاعتماديات: `npm install`.
3. نفّذ البناء: `npm run build`.
4. انشر التحديث: `npm run deploy`.

سيقوم السكربت الأخير بإنشاء الفرع `gh-pages` ورفع ملفات البناء إليه ليتم استضافتها على GitHub Pages في حال رغبت بالنشر اليدوي.

## المكتبات المستخدمة

- SheetJS https://sheetjs.com/
- Daff https://github.com/paulfitz/daff
- Handsontable https://handsontable.com/
- Antd https://ant.design/

## الصيغ المدعومة

- XLSX

## معنى الرموز +++ و ---

- **+++** تمثل صفًا أو خلية تمت إضافتها في الملف المعدَّل.
- **---** تمثل صفًا أو خلية تمت إزالتها من الملف المعدَّل.

![diff](difference.png)
